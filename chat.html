<!DOCTYPE html>
<html>
<head>
<title>Page Title</title>
</head>
<body>

<p id="id"></p>
<p id="debug"></p>
<p id="serverData"></p>
<input id="terminal"></input>

<script src="https://unpkg.com/peerjs@1.0.0/dist/peerjs.min.js"></script>


<script>
var debug = document.getElementById("debug");
var peer = new Peer();
var server = prompt("Server? T or F").toUpperCase();
var keys = [];
document.body.addEventListener("keydown", function(e) {
    keys[e.keyCode] = true;
});
document.body.addEventListener("keyup", function(e) {
    keys[e.keyCode] = false;
});
//Sets up servers or connections
if(server == "T"){
//Just gets the id onscreen, not the best but it works
peer.on("open", function(id){document.getElementById("id").innerHTML = id;});
var terminal = document.getElementById("terminal");
terminal.type = "";
peer.on('connection', function(conn) { 
	conn.on('open', function() {
  		// Receive messages
        conn.send("Hi!");
  		conn.on('data', function(data) {
    		debug.innerHTML += "<br>" + data;
  		});
        
        	setInterval(function(){
        		if(keys[13]){
        			conn.send(terminal.value);
                    terminal.value = "";
         		}
            }, 100);
	});
});
                    peer.on('error', function (err) {
                        console.log(err);
                        alert('' + err);
                    });
} else {
	var conn = peer.connect(prompt("Server ID?"));
    var terminal = document.getElementById("terminal");
    conn.on('open', function() {
		conn.send("Hi!");
  		conn.on('data', function(data) {
    		debug.innerHTML += "<br>" + data;
  		});
        
        	setInterval(function(){
        		if(keys[13]){
        			conn.send(terminal.value);
                    terminal.value = "";
         		}
            }, 100);
	});
    
                        peer.on('error', function (err) {
                        console.log(err);
                        alert('' + err);
                    });
}
</script>

</body>
</html>
