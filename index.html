 
<!DOCTYPE html>
<html>
<head>
<title>Page Title</title>
</head>
<body>

<p id="id"></p>
<p id="debug"></p>
<p id="serverData"></p>
<input id="terminal"></input>

<script src="https://unpkg.com/peerjs@1.0.0/dist/peerjs.min.js"></script>


<script>
var debug = document.getElementById("debug");
var peer = new Peer();
var server = prompt("Server? T or F").toUpperCase();
var keys = [];
document.body.addEventListener("keydown", function(e) {
    keys[e.keyCode] = true;
});
document.body.addEventListener("keyup", function(e) {
    keys[e.keyCode] = false;
});
//Sets up servers or connections
if(server == "T"){
//Just gets the id onscreen, not the best but it works
var players = [];
var ids = [];


//Just shows id on connection open
peer.on("open", function(id){document.getElementById("id").innerHTML = id;} );


var terminal = document.getElementById("terminal");
terminal.type = "";

peer.on('connection', function(conn) { 

	//Creates a list of players, ids, and coordinates
	players.push(conn.metadata);
    ids.push(conn.peer);
    
    
	conn.on('open', function() {
  		// Receive messages
  		conn.on('data', function(data) {
    		debug.innerHTML += "<br>" + data;
  		});
        
        	setInterval(function(){
        		if(keys[13]){
					if(terminal.value == "list"){

                    	//Loop through array and list all users
                        debug.innerHTML = "";
                    	for(var i = 0; i <= players.length; i++){
                            debug.innerHTML += "<br>" + players[0].username;
                        }
                    }
					terminal.value = "";

                    
         	    }
           }, 100);
           
           alert(conn.label.f);
	});
});


function removePlayer(identifierType, identifier){
	var playerIndexToRemove;
	if(identifierType == "username"){
        for(var i = 0; i <= players.length; i++){
        	if(players[i].username == identifier){
    			playerIndexToRemove = i;
                break;
            }
    	}
    
    }
    players.splice(playerIndexToRemove, 1);
    alert(players);
}

peer.on('disconnected', function(conn){
	//Find the player that disconnected, and remove them from the list

	players.pop();
    alert(players);
});

                    peer.on('error', function (err) {
                        console.log(err);
                        alert('' + err);
                    });
} else {
    var username = prompt("Username?");
	var playerX = 200;
    var playerY = 200;

	var conn = peer.connect(prompt("Server ID?"), {
    	reliable:false,
        label: username,
        metadata: {
        	playerX: playerX,
            playerY: playerY,
            username: username
        }
    });
    

}
</script>

</body>
</html>
